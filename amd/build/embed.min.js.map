{"version":3,"file":"embed.min.js","sources":["../src/embed.js"],"sourcesContent":["// This file is part of Moodle - https://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <https://www.gnu.org/licenses/>.\n\n/**\n * Common values helper for the Moodle tiny_keteditor plugin.\n *\n * @module      tiny_keteditor/embed\n * @copyright   2024 Venkatesan Rangarajan <venkatesanrpu@gmail.com>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {\n    get_string as getString\n}\nfrom 'core/str';\nimport Templates from 'core/templates';\nimport Modal from 'core/modal';\nimport Config from 'core/config';\nimport {\n    exception as displayException\n}\nfrom 'core/notification';\n\nexport const KetcherEmbed = class {\n    editor = null;\n    constructor(editor) {\n        this.editor = editor;\n    }\n    init = async() => {\n        const modal = await Modal.create({\n            title: getString('buttonNameTitle', 'tiny_keteditor'),\n            show: true,\n            removeOnClose: true,\n        });\n        Templates.renderForPromise('tiny_keteditor/ketcher_template', {})\n        .then(async({\n                html,\n                js\n            }) => {\n            Templates.appendNodeContents(modal.getBody(), html, js);\n            const scripturl = new URL(`${Config.wwwroot}/lib/editor/tiny/plugins/keteditor/ketcher/static/js/main.963f80c2.js`);\n            var script = document.createElement('script');\n            script.src = scripturl.toString();\n            document.body.appendChild(script); // Append the script to the body\n            const cssurl = new URL(`${Config.wwwroot}/lib/editor/tiny/plugins/keteditor/ketcher/static/css/main.3fc9c0f8.css`);\n            var link = document.createElement('link');\n            link.href = cssurl.toString();\n            link.rel = 'stylesheet';\n            document.head.appendChild(link); // Append the link to the head\n        })\n        .catch((error) => displayException(error));\n    };\n    waitForKetcher = () => {\n        return new Promise((resolve, reject) => {\n            const checkKetcher = setInterval(() => {\n                if (window.ketcher) {\n                    clearInterval(checkKetcher);\n                    resolve(window.ketcher);\n                }\n            }, 100);\n            setTimeout(() => {\n                clearInterval(checkKetcher);\n                reject(new Error('Ketcher loading timeout'));\n            }, 5000); // Timeout after 5 seconds\n        });\n    };\n};"],"names":["editor","constructor","init","async","modal","Modal","create","title","show","removeOnClose","renderForPromise","then","html","js","appendNodeContents","getBody","scripturl","URL","Config","wwwroot","script","document","createElement","src","toString","body","appendChild","cssurl","link","href","rel","head","catch","error","waitForKetcher","Promise","resolve","reject","checkKetcher","setInterval","window","ketcher","clearInterval","setTimeout","Error"],"mappings":";;;;;;;4OAmC4B,MACxBA,OAAS,KACTC,YAAYD,aACHA,OAASA,OAElBE,KAAOC,gBACGC,YAAcC,eAAMC,OAAO,CAC7BC,OAAO,mBAAU,kBAAmB,kBACpCC,MAAM,EACNC,eAAe,uBAETC,iBAAiB,kCAAmC,IAC7DC,MAAKR,MAAAA,WAAMS,KACJA,KADIC,GAEJA,4BAEMC,mBAAmBV,MAAMW,UAAWH,KAAMC,UAC9CG,UAAY,IAAIC,IAAK,GAAEC,gBAAOC,oFAChCC,OAASC,SAASC,cAAc,UACpCF,OAAOG,IAAMP,UAAUQ,WACvBH,SAASI,KAAKC,YAAYN,cACpBO,OAAS,IAAIV,IAAK,GAAEC,gBAAOC,sFAC7BS,KAAOP,SAASC,cAAc,QAClCM,KAAKC,KAAOF,OAAOH,WACnBI,KAAKE,IAAM,aACXT,SAASU,KAAKL,YAAYE,SAE7BI,OAAOC,QAAU,2BAAiBA,UAEvCC,eAAiB,IACN,IAAIC,SAAQ,CAACC,QAASC,gBACnBC,aAAeC,aAAY,KACzBC,OAAOC,UACPC,cAAcJ,cACdF,QAAQI,OAAOC,YAEpB,KACHE,YAAW,KACPD,cAAcJ,cACdD,OAAO,IAAIO,MAAM,8BAClB"}