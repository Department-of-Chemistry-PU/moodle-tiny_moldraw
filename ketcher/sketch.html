<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="Ketcher is a web-based chemical structure editor" />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png" />
    <link rel="manifest" href="./manifest.json" />
    <title>Ketcher v2.15.0</title>
    <script defer="defer" src="./static/js/main.963f80c2.js"></script>
    <link href="./static/css/main.3fc9c0f8.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>
  <body>
  <noscript>You need to enable JavaScript to run this app.</noscript>
  <div class="center">
    <div id="root"></div>
    <p><button onclick="exportMOLfile();">Export Molecule in Molfile</button></p>
    <p><button onclick="exportRXNfile();">Export Molecule in RXNfile</button></p>
  </div>
<script>
  var ketcher = null;

  function blobToBase64(blob) {
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onloadend = () => resolve(reader.result);
      reader.onerror = reject;
      reader.readAsDataURL(blob);
    });
  }

  function outputImage() {
    var output = document.getElementById("output");
    ketcher.getKet().then(struct => ketcher.generateImage(struct, {
      outputFormat: "svg",
      backgroundColor: "255, 255, 255"
    })).then(blob => blobToBase64(blob)).then(base64 => {
      var img = document.createElement('img');
      img.src = base64;
      output.innerHTML = '';
      output.appendChild(img);
    }).catch(error => window.alert(error));
  }

  ///export to mol format and image
  function exportMOLfile() {
    window.ketcher.getMolfile("v2000").then(mol => {
      alert(mol);
      console.log(mol);
      outputImage();
    }).catch(error => {
      console.error(error);
      alert(error);
    });
  }

  ///export to RXN format and image
  function exportRXNfile() {
    window.ketcher.getRxn("v2000").then(rxn => {
      alert(rxn);
      console.log(rxn);
      outputImage();
    }).catch(error => {
      console.error(error);
      alert(error);
    });
  }
</script>

</body>

</html>